<html>
  <head>
    <style type="text/css">
      #box {
        /* -webkit-animation-name: testing; */
        /* -webkit-animation-duration: 1s; */
        /* -webkit-animation-fill-mode: forwards; */

        position: absolute;
        border: 1px #444 solid;
        width: 200px;
        height: 200px;
        background-color: #aaa;
      }
      @-webkit-keyframes testing {
        from {
          -webkit-box-shadow: rgba(0,0,0, .4) 0px 0px 10px;
          background-color: rgba(100,100,0,.75);
        }
        to {
          background-color: rgba(0,100,0,.75);
          -webkit-box-shadow: rgba(0,0,0, .4) 10px 10px 10px;
          -webkit-transform: translateX(700px) rotate(20deg);
          -webkit-transform-origin: translateX(700px);
        }
      }
    </style>
  </head>
  <body>
    <div id="box"></div>
  </body>

  <script type="text/javascript">
    // yay for closures
    (function() {
     var myBox = document.querySelector('#box'),
         animating = false;

     myBox.onclick = function() {
       var that = this;
       animating = true;
       console.log('clicked');
       this.style.webkitAnimationFillMode = 'forwards';
       this.style.webkitAnimation = 'testing 1s';
       // setTimeout(function() { that.style.webkitAnimationPlayState = 'paused'; }, 500);
       this.addEventListener('webkitAnimationIteration', function () {
         console.log('iteration ended');
         this.style.webkitAnimationPlayState = 'paused';
       })
       this.addEventListener('webkitAnimationEnd', function(){
         console.log('ended');
         this.style.webkitAnimationPlayState = 'paused';
       },false);
       // this.addEventListener(animationend, function(){
       //   callfunction()
       // },false);
     }
   }())
  </script>
</html>
